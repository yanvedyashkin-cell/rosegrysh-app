name: Deploy to Firebase Hosting

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4

    - name: Create Web Directory
      run: |
        mkdir -p web
        echo "<!DOCTYPE html>
        <html lang='ru'>
        <head>
            <meta charset='UTF-8'>
            <meta name='viewport' content='width=device-width, initial-scale=1.0'>
            <title>–†–æ–∑—ã–≥—Ä—ã—à –ø–æ–¥–∞—Ä–∫–æ–≤</title>
            <style>
                body { 
                    font-family: Arial, sans-serif; 
                    text-align: center; 
                    padding: 50px; 
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                }
                .container { 
                    max-width: 500px; 
                    margin: 0 auto; 
                    background: rgba(255,255,255,0.1); 
                    padding: 30px; 
                    border-radius: 20px; 
                    backdrop-filter: blur(10px);
                }
                .links a { 
                    display: block; 
                    background: #FFD700; 
                    color: #333; 
                    padding: 15px; 
                    margin: 10px 0; 
                    border-radius: 10px; 
                    text-decoration: none; 
                    font-weight: bold; 
                }
            </style>
        </head>
        <body>
            <div class='container'>
                <h1>üéÅ –†–æ–∑—ã–≥—Ä—ã—à –ø–æ–¥–∞—Ä–∫–æ–≤ üéÅ</h1>
                <p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –Ω–∞ Firebase Hosting!</p>
                <div class='links'>
                    <a href='participant.html'>üöÄ –£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ä–æ–∑—ã–≥—Ä—ã—à–µ</a>
                    <a href='admin.html'>üéÆ –ü–∞–Ω–µ–ª—å –≤–µ–¥—É—â–µ–≥–æ</a>
                </div>
            </div>
        </body>
        </html>" > web/index.html

        echo "<!DOCTYPE html>
        <html lang='ru'>
        <head>
            <meta charset='UTF-8'>
            <meta name='viewport' content='width=device-width, initial-scale=1.0'>
            <title>–£—á–∞—Å—Ç–Ω–∏–∫</title>
            <style>
                body { 
                    font-family: Arial, sans-serif; 
                    text-align: center; 
                    padding: 50px; 
                    background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
                    color: white;
                }
                .container { 
                    max-width: 400px; 
                    margin: 0 auto; 
                    background: rgba(255,255,255,0.1); 
                    padding: 30px; 
                    border-radius: 20px; 
                    backdrop-filter: blur(10px);
                }
            </style>
        </head>
        <body>
            <div class='container'>
                <h1>üéØ –£—á–∞—Å—Ç–Ω–∏–∫ —Ä–æ–∑—ã–≥—Ä—ã—à–∞</h1>
                <p>–°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</p>
                <p><a href='index.html' style='color: #FFD700;'>‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a></p>
            </div>
        </body>
        </html>" > web/participant.html

        echo "<!DOCTYPE html>
        <html lang='ru'>
        <head>
            <meta charset='UTF-8'>
            <meta name='viewport' content='width=device-width, initial-scale=1.0'>
            <title>–ê–¥–º–∏–Ω</title>
            <style>
                body { 
                    font-family: Arial, sans-serif; 
                    text-align: center; 
                    padding: 50px; 
                    background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
                    color: white;
                }
                .container { 
                    max-width: 600px; 
                    margin: 0 auto; 
                    background: rgba(255,255,255,0.1); 
                    padding: 30px; 
                    border-radius: 20px; 
                    backdrop-filter: blur(10px);
                }
            </style>
        </head>
        <body>
            <div class='container'>
                <h1>üéÆ –ü–∞–Ω–µ–ª—å –≤–µ–¥—É—â–µ–≥–æ</h1>
                <p>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ–∑—ã–≥—Ä—ã—à–µ–º</p>
                <p><a href='index.html' style='color: #FFD700;'>‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a></p>
            </div>
        </body>
        </html>" > web/admin.html

    - name: Create Firebase Config
      run: |
        echo '{
          "hosting": {
            "public": "web",
            "ignore": [
              "firebase.json",
              "**/.*",
              "**/node_modules/**"
            ],
            "rewrites": [
              {
                "source": "**",
                "destination": "/index.html"
              }
            ]
          }
        }' > firebase.json

    - name: Deploy to Firebase
      uses: FirebaseExtended/action-hosting-deploy@v0
      with:
        repoToken: '${{ secrets.GITHUB_TOKEN }}'
        firebaseServiceAccount: '${{ secrets.FIREBASE_SERVICE_ACCOUNT }}'
        channelId: live
        projectId: '${{ secrets.FIREBASE_PROJECT_ID }}'
